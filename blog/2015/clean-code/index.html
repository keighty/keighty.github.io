
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Clean Code - keighty</title>
  <meta name="author" content="katie leonard">

  
  <meta name="description" content="The book club I belong to has a two-fold mission: the first is to inspire through peer pressure to read (and finish) technical books, and the second &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.katieleonard.ca/blog/2015/clean-code">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="keighty" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41587719-1', 'auto');
  ga('send', 'pageview');

</script>



</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">keighty</a></h1>
  
    <h2>reading, writing, rambling</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.katieleonard.ca" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/projects/index.html">Projects</a></li>
  <li><a href="/reads/index.html">Reads</a></li>
  <li><a href="/more-about-keighty/index.html">More about keighty</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Clean Code</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-07T00:00:00-08:00" pubdate data-updated="true">Feb 7<span>th</span>, 2015</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>The book club I belong to has a two-fold mission: the first is to inspire through peer pressure to read (and finish) technical books, and the second is to improve our ability to write quality, maintainable code. We started with <a href="http://www.amazon.com/Practical-Object-Oriented-Design-Ruby-Addison-Wesley/dp/0321721330/ref=sr_1_1?ie=UTF8&amp;qid=1423423708&amp;sr=8-1&amp;keywords=practical+object-oriented+design+in+ruby"><em>Practical Object Oriented Design in Ruby</em></a> (Sandi Metz), and are now on to <a href="http://www.amazon.com/s/ref=nb_sb_ss_i_0_11?url=search-alias%3Daps&amp;field-keywords=refactoring&amp;sprefix=refactoring%2Caps%2C217"><em>Refactoring</em></a> (Martin Fowler and Kent Beck). Along the way, I found a copy of <a href="http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882/ref=sr_1_1?ie=UTF8&amp;qid=1423423781&amp;sr=8-1&amp;keywords=clean+code"><em>Clean Code</em></a> by Robert C. Martin in our work library, and dove right in. These three books tout many of the the same principles but focus on different aspects of writing quality code: POODR teaches how to identify abstractions, and to design decoupled objects; Refactoring is a deep dive into the techniques and heuristics for eliminating common code smells; and Clean Code is the intersection between them. It is a style guide, a call to action, and a cautionary tale from the voices of experience. I had several aha moments while reading Clean Code, and here are a few<!--more-->:</p>

<h3>Error handling</h3>

<p>When I started to anticipate <code>undefined method 'length' for nil:NilClass</code> errors, I knew I was growing as a developer.
Having traced the source of <code>undefined is not a function</code> enough times, I came to realize that I was not sufficiently controlling the messages passing between objects.</p>

<figure class='code'><figcaption><span>Could return nil </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">find_a_user</span>
</span><span class='line'>  <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">last_name</span><span class="p">:</span> <span class="s2">&quot;Bacon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="ss">:find_a_user</span>
</span><span class='line'>
</span><span class='line'><span class="n">find_a_user</span>
</span><span class='line'><span class="vi">@user</span><span class="o">.</span><span class="n">last_name</span>
</span><span class='line'>
</span><span class='line'><span class="ss">NoMethodError</span><span class="p">:</span> <span class="n">undefined</span> <span class="nb">method</span> <span class="sb">`last_name&#39; for nil:NilClass</span>
</span><span class='line'><span class="sb">from (pry):10:in `</span><span class="n">__pry__</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This first pass seemed totally reasonable to me &mdash; find a particular user, and return it. Of course, what if the user doesn&rsquo;t exist? What if the query timed out? The code on line 7 is reasonable (wherever it may live), but if <code>@user</code> is set to nil my app will blow up. <span class='pullquote-right' data-pullquote='The problem isn&#8217;t that the code is missing a null check, but that it has too many.'>The worst part is, it will blow up at quite a distance from where the actual problem is. A naive solution would be to check if <code>@user</code> is nil before calling <code>#last_name</code> on it (<code>@user.last_name if @user</code>), but this leads to unreadable, untrustworthy code. The problem isn&rsquo;t that the code is missing a null check, but that it has too many. I have a poor contract with <code>User</code> if I have to check its validity every time I ask it a question. Martin suggests a more sustainable solution &mdash; <em>never return <code>nil</code></em>. If you never return <code>nil</code>, you don&rsquo;t have to catch <code>nil</code>.
</span></p>

<blockquote><p>If you are calling a [nil]-returning method from a third-party API, consider wrapping that method with a method that either throws an exception or returns a special case object.</p></blockquote>

<figure class='code'><figcaption><span>Never returns nil </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">find_a_user</span>
</span><span class='line'>  <span class="k">if</span> <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">last_name</span><span class="p">:</span> <span class="s2">&quot;Bacon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'>    <span class="vi">@user</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="k">raise</span> <span class="no">StandardError</span><span class="o">.</span><span class="n">new</span> <span class="s2">&quot;Could not find Mr. Bacon.&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">find_a_user</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="ss">StandardError</span><span class="p">:</span> <span class="no">Could</span> <span class="ow">not</span> <span class="n">find</span> <span class="no">Mr</span><span class="o">.</span> <span class="no">Bacon</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now the error occurs where it belongs &mdash; with the retrieval of the user. Throwing an error when something goes wrong is the least you can do for the consumers of your method. You could also solidify your contract by guaranteeing that you return something they expect.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">interesting_things</span>
</span><span class='line'>  <span class="vi">@interesting_things</span> <span class="o">||</span> <span class="o">[]</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">interesting_things</span><span class="o">.</span><span class="n">length</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>I have guaranteed that <code>#interesting_things</code> will always return either the collection I expect or a reasonable facscimile. It is a simple enough solution, but I definitely felt that message sink into place. Methods are objects and objects have API&rsquo;s: messages in and messages out. Make those messages deliberate, because if &ldquo;returning null from methods is bad, passing null into methods is worse.&rdquo;</p>

<h3>Protect Your Boundaries</h3>

<p>Controlling the messages going in to and coming out of your objects is one place you need to protect your boundaries, but what about objects from 3rd party libraries or frameworks? There are consequences of relying too heavily on a library API, and in Chapter 9: Boundaries, James Grenning shares a few of them. One system he was working with collected information by passing around a Map collection, which is a standard library data structure in Java. In the next version of Java, new capabilities were added, and in order to use the new feature they had to find everywhere the object was used and make the change.</p>

<blockquote><p>We&rsquo;ve seen systems that are inhibited from using [the new feature] because of the sheer magnitude of changes needed to make up for the liberal use of Maps.</p></blockquote>

<p>I recently had a similar experience when upgrading an application from Rails 3.0 to Rails 3.2, where there were drastic changes to how models record errors. Errors inherited from OrderedHash in Rails 3.0 and from ActiveModel in Rails 3.2 &mdash; very different object types. Every test that looked for errors called <code>errors.on</code> &mdash; now a deprecated method. Every place that looped over the collection with <code>errors.each</code> had to be changed to <code>errors.messages.each</code>, or the logic modified altogether. It is good practice to be distrustful of APIs that are likely to change, and while I don&rsquo;t believe that the Errors object ever seemed unstable, it has certainly made me extra cautious of calling 3rd party framework methods directly.</p>

<h3>Clean Code is not a &ldquo;nice-to-have&rdquo;</h3>

<p>Technical debt is not a decision to be okay with untested, brittle code that is impossible to build on &mdash; it is a decision to pursue a design that may not be scalable, but it can still be clean. It is tempting to declare &ldquo;Mission Accomplished&rdquo; when you have reached the point of working code, but the job is really only half done:</p>

<blockquote><p>It is not enough for code to work. Code that works is often badly broken. Programers who satisfy themselves with merely working code are behaving unprofessionally. They may fear that they don&rsquo;t have time to improve the structure and design of their code, but I disagree. Nothing has a more profound and long term degrading effect upon a development project than bad code. Bad schedules can be redone, bad requirements can be redefined. Bad team dynamics can be repaired. But bad code rots and ferments, becoming an inexorable weight that drags the team down.</p></blockquote>

<p>A story cannot be declared finished until the code is ammenable to change. In order to change code, it must be comprehensible and thoroughly tested. Compromising code quality to meet the demands of a schedule will only slow things down in the long run.</p>

<p><em>Clean Code</em> is a must read for all professional software developers. Leaving clean code is not just a kindness to the next developer (which is likely to be you), but is essential for growing a healthy codebase. Of course, &ldquo;to write clean code, you must first write dirty code and then clean it,&rdquo; and I look forward to learning new techniques as we tackle <em>Refactoring</em>.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">katie leonard</span></span>

      








  


<time datetime="2015-02-07T00:00:00-08:00" pubdate data-updated="true">Feb 7<span>th</span>, 2015</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/read/'>read</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.katieleonard.ca/blog/2015/clean-code/" data-via="KeightyLeonard" data-counturl="http://www.katieleonard.ca/blog/2015/clean-code/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/debugging-techniques/" title="Previous Post: debugging techniques">&laquo; debugging techniques</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/everybody-writes/" title="Next Post: everybody writes (and why you should blog)">everybody writes (and why you should blog) &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <div class='contact'>
    <a href='mailto:keighty.leonard@gmail.com?Subject=Hello!' rel='tooltip' title='keighty.leonard@gmail.com'><i class="fa fa-envelope fa-3x"></i></a>
    <a href='http://twitter.com/KeightyLeonard' title='@KeightyLeonard'><i class="fa fa-twitter fa-3x"></i></a>
    <a href='http://github.com/keighty' title='github.com/keighty'><i class="fa fa-github fa-3x"></i></a>
    <a href='http://linkedin.com/in/katieleonard' title='linkedin/katieleonard'><i class="fa fa-linkedin fa-3x"></i></a>
  </div>
</section><section>
  <div>
    <h1>Check out my book!</h1>
    <a href="http://codeschoolbook.com" target="_blank"><img src="/images/code_school_book.png"></a>
  </div>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/keightys-2015-by-the-numbers/">Keighty's 2015 - by the Numbers</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/faster-asset-loading-with-cache-control/">Faster Asset Loading With Cache-Control</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/javascript-object-property-meta-properties/">Javascript Object Property Meta Properties</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/software-estimation-is-hard/">Estimate != Commitment != Target</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/the-clean-coder/">The Clean Coder</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'keighty',
            count: 4,
            skip_forks: true,
            skip_repos: [ "keighty.github.io" ],
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <div>
    <h1><a href="/more-about-keighty/index.html">Aboot me</a></h1>
    <p>I have loved programming since my first "Hello World!", and have been seeking source code enlightenment through Java, Ruby, Rails, and JavaScript. I am also a recent immigrant to Portland, Oregon - perhaps you can tell from my Canadian accent?</p>
  </div>
</section>


<section class="well">
  <h1><a href="http://coderwall.com/keighty">@keighty</a> on Coderwall</h1>

  <div id="coderwall_badges"></div>

  <script type="text/javascript">
    $(document).ready(function(){
      $.getJSON("http://coderwall.com/keighty.json?callback=?", function(data){
        for(var i = 0; i < data.data.badges.length ; i++){
          var badge = data.data.badges[i];
          var description = badge.name + ":\n" + badge.description;
          var badge_tag = $("<img title='" + description + "'/>");
          badge_tag.attr("src",badge.badge);
          badge_tag.css("width","25%");
          $("#coderwall_badges").append(badge_tag);
        }
      });
    });
  </script>
</section>
 <section>
  <div>
    <h1>Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/KeightyLeonard" data-widget-id="434861084550262784">Tweets by @KeightyLeonard</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </div>
 </section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - katie leonard -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41587719-1', 'katieleonard.ca');
  ga('send', 'pageview');

</script>


</body>
</html>
